# FROM NNS-Python
x <- c(0.69646919,0.28613933,0.22685145,0.55131477,0.71946897,0.42310646,0.9807642,0.68482974,0.4809319,0.39211752,0.34317802,0.72904971,0.43857224,0.0596779,0.39804426,0.73799541,0.18249173,0.17545176,0.53155137,0.53182759,0.63440096,0.84943179,0.72445532,0.61102351,0.72244338,0.32295891,0.36178866,0.22826323,0.29371405,0.63097612,0.09210494,0.43370117,0.43086276,0.4936851,0.42583029,0.31226122,0.42635131,0.89338916,0.94416002,0.50183668,0.62395295,0.1156184,0.31728548,0.41482621,0.86630916,0.25045537,0.48303426,0.98555979,0.51948512,0.61289453,0.12062867,0.8263408,0.60306013,0.54506801,0.34276383,0.30412079,0.41702221,0.68130077,0.87545684,0.51042234,0.66931378,0.58593655,0.6249035,0.67468905,0.84234244,0.08319499,0.76368284,0.24366637,0.19422296,0.57245696,0.09571252,0.88532683,0.62724897,0.72341636,0.01612921,0.59443188,0.55678519,0.15895964,0.15307052,0.69552953,0.31876643,0.6919703,0.55438325,0.38895057,0.92513249,0.84167,0.35739757,0.04359146,0.30476807,0.39818568,0.70495883,0.99535848,0.35591487,0.76254781,0.59317692,0.6917018,0.15112745,0.39887629,0.2408559,0.34345601)
y <- c(0.92909535,0.30014476,0.20646817,0.7712467,0.17920768,0.72036963,0.29786512,0.68433015,0.60207748,0.87620702,0.7616916,0.64924029,0.34861461,0.53089005,0.31884301,0.69112156,0.78452488,0.86262023,0.41358953,0.86721538,0.80634672,0.747321,0.08726848,0.02395764,0.05061124,0.46636424,0.42239815,0.47448962,0.53418632,0.78091318,0.81987543,0.71117912,0.4997589,0.50180971,0.79913566,0.03560152,0.9216018,0.27334142,0.78248285,0.39558261,0.48270236,0.59312597,0.27317981,0.85701595,0.53195614,0.14553153,0.67555243,0.27625359,0.27230102,0.68109775,0.94930473,0.80762382,0.94515281,0.64020253,0.82587833,0.63006449,0.38930902,0.2416397,0.1840276,0.60316031,0.65667033,0.21177485,0.43594359,0.22965129,0.13087654,0.59897349,0.66883574,0.80937237,0.3620941,0.85133513,0.65516065,0.85547907,0.13596215,0.10883347,0.54480159,0.87281141,0.66216522,0.8701364,0.84532493,0.62831992,0.20690841,0.51765115,0.64485156,0.42666354,0.97186108,0.24973275,0.05193778,0.64697198,0.36983921,0.8167219,0.71028081,0.26067349,0.42187116,0.79349008,0.93981151,0.76253797,0.03975017,0.04013739,0.16805411,0.78433601)

T_ORDER <- 2
T_DT <- data.table::data.table(x, y, quadrant = "q", prior.quadrant = "pq")
T_DT$quadrant <- c("q11","q44","q44","q12","q34","q23","q31","q13","q23","q21","q23","q13","q41","q42","q43","q13","q22","q22","q32","q12","q12","q13","q34","q34","q34","q41","q41","q42","q42","q12","q22","q23","q41","q41","q21","q44","q21","q31","q11","q41","q32","q24","q43","q21","q31","q44","q23","q31","q32","q14","q22","q11","q12","q14","q21","q23","q41","q32","q33","q14","q14","q34","q32","q34","q33","q24","q13","q22","q42","q12","q24","q11","q34","q34","q42","q12","q14","q22","q22","q13","q43","q32","q14","q41","q11","q31","q43","q24","q42","q21","q13","q31","q41","q11","q12","q11","q44","q43","q44","q21")
T_DT$prior.quadrant <- c("q1","q4","q4","q1","q3","q2","q3","q1","q2","q2","q2","q1","q4","q4","q4","q1","q2","q2","q3","q1","q1","q1","q3","q3","q3","q4","q4","q4","q4","q1","q2","q2","q4","q4","q2","q4","q2","q3","q1","q4","q3","q2","q4","q2","q3","q4","q2","q3","q3","q1","q2","q1","q1","q1","q2","q2","q4","q3","q3","q1","q1","q3","q3","q3","q3","q2","q1","q2","q4","q1","q2","q1","q3","q3","q4","q1","q1","q2","q2","q1","q4","q3","q1","q4","q1","q3","q4","q2","q4","q2","q1","q3","q4","q1","q1","q1","q4","q4","q4","q2")
T_regression_points <- data.table::data.table(
  "quadrant"= c("q1", "q2", "q3", "q4"),
  "x"=c(0.66995562,0.28738332,0.7316866,0.31421562),
  "y"=c(0.7618939,0.7711931,0.23890044,0.34000694)
)
R1 <- NNS.part(x,y,Voronoi=FALSE)

test_that(
	"NNS.part", {
	  expect_equal(R1$order, T_ORDER, tolerance=1e-5)
	  expect_equal(R1$dt, T_DT, tolerance=1e-5)
	  expect_equal(R1$regression.points, T_regression_points, tolerance=1e-5)
	}
)
